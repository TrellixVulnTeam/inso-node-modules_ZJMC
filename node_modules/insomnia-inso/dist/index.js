module.exports=function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=11)}([function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.configureLogger=t.logger=t.noConsoleLog=void 0;const a=r(n(19)),s=n(7);t.noConsoleLog=async e=>{const t=console.log;console.log=s.noop;try{return await e()}finally{console.log=t}};const l=a.default.create({reporters:[new a.FancyReporter({formatOptions:{date:!1}})]});l.__getLogs=()=>({}),t.logger=l;t.configureLogger=(e=!1,n=!1)=>{t.logger.level=e?a.LogLevel.Verbose:a.LogLevel.Info,n&&t.logger.setReporters([new a.BasicReporter])}},function(e,t){e.exports=require("path")},function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.loadDb=t.emptyDb=void 0;const i=o(n(15)),r=o(n(16)),a=n(7),s=n(20),l=n(0),u=o(n(1));t.emptyDb=()=>({ApiSpec:[],Environment:[],Request:[],RequestGroup:[],Workspace:[],UnitTest:[],UnitTestSuite:[]});t.loadDb=async({workingDir:e,appDataDir:n,filterTypes:o}={})=>{let c=null;if(!n){const t=e||".";c=await i.default(t,o),c&&l.logger.debug(`Data store configured from git repository at \`${u.default.resolve(t)}\``)}if(!c){const e=n||s.getAppDataDir(a.getDefaultAppName());if(c=await r.default(e,o),c&&l.logger.debug(`Data store configured from app data directory at \`${u.default.resolve(e)}\``),!c&&!n){const e=s.getAppDataDir("Insomnia Designer");c=await r.default(e),c&&l.logger.debug(`Data store configured from Insomnia Designer app data directory at \`${u.default.resolve(e)}\``)}}return c||(l.logger.warn("No git or app data store found, re-run `inso` with `--verbose` to see tracing information"),c=t.emptyDb()),c}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleError=t.InsoError=void 0;const o=n(0);class i extends Error{constructor(e,t){super(e),this.name="InsoError",this.cause=t}}t.InsoError=i;t.handleError=e=>{e instanceof i?(o.logger.fatal(e.message),e.cause&&o.logger.error(e.cause)):e&&o.logger.error(e),o.logger.info("To view tracing information, re-run `inso` with `--verbose`")}},function(e,t){e.exports=require("fs")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promptApiSpec=t.loadApiSpec=void 0;const o=n(6),i=n(8),r=n(0),a="api specification";t.loadApiSpec=(e,t)=>{r.logger.trace("Load %s with identifier `%s` from data store",a,t);const n=e.ApiSpec.filter(e=>o.matchIdIsh(e,t)||e.fileName===t);return r.logger.trace("Found %d.",n.length),o.ensureSingleOrNone(n,a)};t.promptApiSpec=async(e,n)=>{if(n||!e.ApiSpec.length)return null;const s=new i.AutoComplete({name:"apiSpec",message:"Select an API Specification",choices:e.ApiSpec.map(e=>o.getDbChoice(o.generateIdIsh(e),e.fileName))});r.logger.trace("Prompt for %s",a);const[l]=(await s.run()).split(" - ").reverse();return t.loadApiSpec(e,l)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensureSingle=t.ensureSingleOrNone=t.getDbChoice=t.generateIdIsh=t.matchIdIsh=void 0;const o=n(3);t.matchIdIsh=({_id:e},t)=>e.startsWith(t);function i(e,t,n="  |"){if(!e||e<0)return t;return`${new Array(e+1).join(n)} ${t}`}t.generateIdIsh=({_id:e},t=10)=>e.substr(0,t);t.getDbChoice=(e,t,n={})=>({name:e,message:i(n.indent||0,t),value:`${t} - ${e}`,hint:n.hint||""+e});t.ensureSingleOrNone=(e,t)=>{if(1===e.length)return e[0];if(0===e.length)return null;throw new o.InsoError(`Expected single or no ${t} in the data store, but found multiple (${e.length}).`)};t.ensureSingle=(e,t)=>{if(1===e.length)return e[0];if(0===e.length)throw new o.InsoError(`Expected single ${t} in the data store, but found none.`);throw new o.InsoError(`Expected single ${t} in the data store, but found multiple (${e.length}).`)}},function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.noop=t.getDefaultAppName=t.exit=t.logErrorExit1=t.isDevelopment=t.getVersion=void 0;const i=o(n(18)),r=n(3);t.getVersion=()=>t.isDevelopment()?"dev":i.default.version;t.isDevelopment=()=>!1;t.logErrorExit1=e=>{r.handleError(e),process.exit(1)};t.exit=async e=>e.then(e=>process.exit(e?0:1)).catch(t.logErrorExit1);t.getDefaultAppName=()=>"Insomnia";t.noop=()=>{}},function(e,t){e.exports=require("enquirer")},function(e,t){e.exports=require("yaml")},function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.writeFileWithCliOptions=void 0;const i=o(n(1)),r=o(n(22)),a=o(n(4)),s=n(3);t.writeFileWithCliOptions=async function(e,t,n){const o=i.default.isAbsolute(e)?e:i.default.join(n||".",e);try{return await r.default.sync(i.default.dirname(o)),await a.default.promises.writeFile(o,t),o}catch(e){throw new s.InsoError(`Failed to write to "${o}"`,e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.go=void 0;var o=n(12);Object.defineProperty(t,"go",{enumerable:!0,get:function(){return o.go}})},function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.go=void 0;const i=n(13),r=n(7),a=n(23),s=n(30),l=n(32),u=n(33),c=o(n(34)),p=n(0),d=n(35),f=e=>(p.configureLogger(e.verbose,e.ci),e.printOptions&&p.logger.log("Loaded options",e,"\n"),e);t.go=(e,t)=>{const n=e=>{const n=new c.default.Command(e).storeOptionsAsProperties(!1);return t&&n.exitOverride(),n};p.configureLogger();const o=n();var m;o.version(r.getVersion(),"-v, --version").description("A CLI for Insomnia!"),o.option("-w, --workingDir <dir>","set working directory").option("-a, --appDataDir <dir>","set the app data directory").option("--config <path>","path to configuration file").option("--verbose","show additional logs while running the command").option("--printOptions","print the loaded options").option("--ci","run in CI, disables all prompts"),o.addCommand((e=>{const t=e("generate").description("Code generation utilities");return t.command("config [identifier]").description("Generate configuration from an api spec.").option("-t, --type <value>",`type of configuration to generate, options are [${i.conversionOptions.join(", ")}] (default: declarative)`).option("--tags <tags>","comma separated list of tags to apply to each entity").option("-o, --output <path>","save the generated config to a file").action((e,t)=>{let n=d.getOptions(t,{type:"declarative"});return n=f(n),r.exit(i.generateConfig(e,n))}),t})(n)).addCommand((e=>{const t=e("run").description("Execution utilities");return t.command("test [identifier]").description("Run Insomnia unit test suites").option("-e, --env <identifier>","environment to use").option("-t, --testNamePattern <regex>","run tests that match the regex").option("-r, --reporter <reporter>",`reporter to use, options are [${a.reporterTypes.join(", ")}] (default: spec)`).option("-b, --bail",'abort ("bail") after first test failure').option("--keepFile","do not delete the generated test file").action((e,t)=>{let n=d.getOptions(t,{reporter:"spec"});return n=f(n),r.exit(a.runInsomniaTests(e,n))}),t})(n)).addCommand((e=>{const t=e("lint").description("Linting utilities");return t.command("spec [identifier]").description("Lint an API Specification").action((e,t)=>{let n=d.getOptions(t);return n=f(n),r.exit(s.lintSpecification(e,n))}),t})(n)).addCommand((e=>{const t=e("export").description("Export data from insomnia models");return t.command("spec [identifier]").description("Export an API Specification to a file").option("-o, --output <path>","save the generated config to a file").action((e,t)=>{let n=d.getOptions(t);return n=f(n),r.exit(l.exportSpecification(e,n))}),t})(n)),(m=o).command("script <name>",{isDefault:!0}).description("Run scripts defined in .insorc").allowUnknownOption().action((e,t)=>{var n,o;let i=d.getOptions(t);i=f(i);const a=t.args.slice(1),s=null===(o=null===(n=i.__configFile)||void 0===n?void 0:n.scripts)||void 0===o?void 0:o[e];if(!s)return p.logger.fatal(`Could not find inso script "${e}" in the config file.`),r.exit(new Promise(e=>e(!1)));if(!s.startsWith("inso"))return p.logger.fatal("Tasks in a script should start with `inso`."),r.exit(new Promise(e=>e(!1)));const l=u.parseArgsStringToArgv(`self ${s} ${a.join(" ")}`);p.logger.debug(">> "+l.slice(1).join(" ")),g(m,l)}),g(o,e||process.argv)};const g=(e,t)=>{e.parseAsync(t).catch(r.logErrorExit1)}},function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.generateConfig=t.conversionTypeMap=t.conversionOptions=void 0;const i=n(14),r=o(n(9)),a=o(n(1)),s=n(2),l=n(5),u=n(10),c=n(0),p=n(3);t.conversionOptions=["declarative","kubernetes"],t.conversionTypeMap={kubernetes:"kong-for-kubernetes",declarative:"kong-declarative-config"};t.generateConfig=async(e,n={})=>{if(!((e={})=>{const{type:n}=e;return!(!n||!t.conversionTypeMap[n])||(c.logger.fatal(`Config type "${n}" not unrecognized. Options are [${t.conversionOptions.join(", ")}].`),!1)})(n))return!1;const{type:o,output:d,tags:f,appDataDir:g,workingDir:m,ci:h}=n,v=await s.loadDb({workingDir:m,appDataDir:g,filterTypes:["ApiSpec"]});let b=null;const y=e?l.loadApiSpec(v,e):await l.promptApiSpec(v,!!h),_=null==f?void 0:f.split(","),w=t.conversionTypeMap[o];try{if(null==y?void 0:y.contents)c.logger.trace("Generating config from database contents"),b=await i.generateFromString(y.contents,w,_);else if(e){const t=a.default.isAbsolute(e)?e:a.default.join(m||".",e);c.logger.trace(`Generating config from file \`${t}\``),b=await i.generate(t,w,_)}}catch(e){throw new p.InsoError("There was an error while generating configuration",e)}if(!(null==b?void 0:b.documents)||!Array.isArray(b.documents))return c.logger.log("Could not find a valid specification to generate configuration."),!1;const D=b.documents.map(e=>r.default.stringify(e)).join("\n---\n").replace(/\n+---\n+/g,"\n---\n");if(d){const e=await u.writeFileWithCliOptions(d,D,m);c.logger.log(`Configuration generated to "${e}".`)}else c.logger.log(D);return!0}},function(e,t){e.exports=require("openapi-2-kong")},function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(n(4)),r=o(n(9)),a=o(n(1)),s=n(2);t.default=async(e,t)=>{if(e=a.default.join(e,".insomnia"),!i.default.existsSync(a.default.join(e,"Workspace")))return null;const n=s.emptyDb(),o=(null==t?void 0:t.length)?t:Object.keys(n);return await Promise.all(o.map(async t=>{const o=a.default.join(e,t);if(!i.default.existsSync(o))return;const s=await i.default.promises.readdir(o);return Promise.all(s.map(o=>(async(e,t)=>{const o=await i.default.promises.readFile(t),a=r.default.parse(o.toString());n[e].push(a)})(t,a.default.join(e,t,o))))})),n}},function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(n(1)),r=o(n(17)),a=n(2),s=o(n(4));t.default=async(e,t)=>{if(!s.default.existsSync(i.default.join(e,"insomnia.Workspace.db")))return null;const n=a.emptyDb(),o=((null==t?void 0:t.length)?t:Object.keys(n)).map(t=>new Promise((o,a)=>{const s=i.default.join(e,`insomnia.${t}.db`);new r.default({autoload:!0,filename:s,corruptAlertThreshold:.9}).find({},(e,i)=>{if(e)return a(e);n[t].push(...i),o(null)})}));return await Promise.all(o),n}},function(e,t){e.exports=require("nedb")},function(e){e.exports=JSON.parse('{"name":"insomnia-inso","version":"2.3.0","homepage":"https://insomnia.rest","description":"A CLI for Insomnia Designer - the collaborative API design tool.","author":"Kong <office@konghq.com>","license":"Apache-2.0","repository":{"type":"git","url":"https://github.com/Kong/insomnia.git","directory":"packages/insomnia-inso"},"bugs":{"url":"https://github.com/kong/insomnia/issues"},"main":"dist/index.js","types":"dist/index.d.ts","bin":{"inso":"bin/inso"},"scripts":{"bootstrap":"npm run build","lint":"eslint . --ext .js,.ts,.tsx","lint:fix":"npm run lint -- --fix","clean":"tsc --build tsconfig.build.json --clean","postclean":"rimraf dist","test":"jest --runInBand","test:watch":"npm run test -- --watch","test:snapshots":"npm run build && npm run test -- -u","prebuild":"npm run clean","build":"webpack --config webpack/webpack.config.development.js","build:production":"webpack --config webpack/webpack.config.production.js --display errors-only","start":"npm run build -- --watch","prepare":"npm run build:production"},"devDependencies":{"@babel/core":"^7.9.0","@babel/plugin-proposal-optional-chaining":"^7.9.0","@babel/preset-env":"^7.10.2","@babel/preset-flow":"^7.10.1","@types/babel__core":"^7.1.12","@types/babel__preset-env":"^7.9.1","@types/lodash.flattendeep":"^4.4.6","@types/mkdirp":"^1.0.1","@types/nedb":"^1.8.11","@types/node":"^14.14.32","@types/rimraf":"^3.0.0","@types/webpack-node-externals":"^2.5.0","@types/yaml":"^1.9.7","execa":"^5.0.0","get-bin-path":"^5.1.0","node-loader":"1.0.2","rimraf":"^3.0.2","ts-loader":"^8.2.0","webpack":"4.44.1","webpack-cli":"^3.3.12","webpack-merge":"^5.0.7","webpack-node-externals":"^1.7.2"},"dependencies":{"@stoplight/spectral":"^5.4.0","commander":"^5.1.0","consola":"^2.15.0","cosmiconfig":"^6.0.0","enquirer":"^2.3.6","insomnia-plugin-base64":"2.3.0","insomnia-plugin-cookie-jar":"2.3.0","insomnia-plugin-core-themes":"2.3.0","insomnia-plugin-file":"2.3.0","insomnia-plugin-hash":"2.3.0","insomnia-plugin-jsonpath":"2.3.0","insomnia-plugin-now":"2.3.0","insomnia-plugin-os":"2.3.0","insomnia-plugin-prompt":"2.3.0","insomnia-plugin-request":"2.3.0","insomnia-plugin-response":"2.3.0","insomnia-plugin-uuid":"2.3.0","insomnia-send-request":"2.3.0","insomnia-testing":"2.3.0","lodash.flattendeep":"^4.4.0","mkdirp":"^1.0.4","nedb":"^1.8.0","openapi-2-kong":"2.3.0","string-argv":"^0.3.1","yaml":"^1.10.0"},"gitHead":"c2c41f3d848e5c04f8a3793695037bff17119ad5"}')},function(e,t){e.exports=require("consola")},function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getAppDataDir=void 0;const i=o(n(1)),r=n(21);t.getAppDataDir=function(e){switch(process.platform){case"darwin":return i.default.join(r.homedir(),"Library","Application Support",e);case"win32":return i.default.join(process.env.APPDATA||i.default.join(r.homedir(),"AppData","Roaming"),e);case"linux":return i.default.join(process.env.XDG_DATA_HOME||i.default.join(r.homedir(),".config"),e);default:return""}}},function(e,t){e.exports=require("os")},function(e,t){e.exports=require("mkdirp")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runInsomniaTests=t.reporterTypesSet=t.reporterTypes=void 0;const o=n(24),i=n(2),r=n(0),a=n(25),s=n(28);t.reporterTypes=["dot","list","min","progress","spec"],t.reporterTypesSet=new Set(t.reporterTypes);t.runInsomniaTests=async function(e,l){if(!function({reporter:e}){return!(e&&!t.reporterTypesSet.has(e))||(r.logger.fatal(`Reporter "${e}" not unrecognized. Options are [${t.reporterTypes.join(", ")}].`),!1)}(l))return!1;const{reporter:u,bail:c,keepFile:p,appDataDir:d,workingDir:f,env:g,ci:m,testNamePattern:h}=l,v=await i.loadDb({workingDir:f,appDataDir:d}),b=e?a.loadTestSuites(v,e):await a.promptTestSuites(v,!!m);if(!b.length)return r.logger.fatal("No test suites found; cannot run tests."),!1;const y=b[0].parentId,_=g?s.loadEnvironment(v,y,g):await s.promptEnvironment(v,!!m,y);if(!_)return r.logger.fatal("No environment identified; cannot run tests without a valid environment."),!1;const w=o.generate(b.map(e=>{return t=e,n=v.UnitTest.filter(t=>t.parentId===e._id),{name:t.name,suites:[],tests:n.map(({name:e,code:t,requestId:n})=>({name:e,code:t,defaultRequestId:n}))};var t,n})),{getSendRequestCallbackMemDb:D}=n(29),S=await D(_._id,v);return await r.noConsoleLog(()=>o.runTestsCli(w,{reporter:u,bail:c,keepFile:p,sendRequest:S,testFilter:h}))}},function(e,t){e.exports=require("insomnia-testing")},function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.promptTestSuites=t.loadTestSuites=t.loadUnitTestSuite=void 0;const i=n(5),r=n(8),a=o(n(26)),s=n(6),l=n(27),u=n(0);t.loadUnitTestSuite=(e,t)=>{u.logger.trace("Load unit test suite with identifier `%s` from data store",t);const n=e.UnitTestSuite.filter(e=>s.matchIdIsh(e,t)||e.name===t);return u.logger.trace("Found %d.",n.length),s.ensureSingleOrNone(n,"unit test suite")};t.loadTestSuites=(e,n)=>{const o=i.loadApiSpec(e,n),r=l.loadWorkspace(e,(null==o?void 0:o.parentId)||n);if(r)return e.UnitTestSuite.filter(e=>e.parentId===r._id);const a=t.loadUnitTestSuite(e,n);return a?[a]:[]};t.promptTestSuites=async(e,n)=>{if(n)return[];const o=e.ApiSpec.map(t=>[s.getDbChoice(s.generateIdIsh(t),t.fileName),...e.UnitTestSuite.filter(e=>e.parentId===t.parentId).map(e=>s.getDbChoice(s.generateIdIsh(e),e.name,{indent:1}))]);if(!o.length)return[];const i=new r.AutoComplete({name:"testSuite",message:"Select a document or unit test suite",choices:a.default(o)});u.logger.trace("Prompt for document or test suite");const[l]=(await i.run()).split(" - ").reverse();return t.loadTestSuites(e,l)}},function(e,t){e.exports=require("lodash.flattendeep")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadWorkspace=void 0;const o=n(6),i=n(0);t.loadWorkspace=(e,t)=>{i.logger.trace("Load workspace with identifier `%s` from data store",t);const n=e.Workspace.filter(e=>o.matchIdIsh(e,t)||e.name===t);return i.logger.trace("Found %d.",n.length),o.ensureSingleOrNone(n,"workspace")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promptEnvironment=t.loadEnvironment=void 0;const o=n(8),i=n(6),r=n(0),a=(e,t)=>{r.logger.trace("Load base environment for the workspace `%s` from data store",t);const n=e.Environment.filter(e=>e.parentId===t);return r.logger.trace("Found %d.",n.length),i.ensureSingle(n,"base environment")};t.loadEnvironment=(e,t,n)=>{if(!e.Environment.length)return null;const o=a(e,t),s=e.Environment.filter(e=>e.parentId===o._id);if(!n)return r.logger.trace("No sub environments found, using base environment"),o;r.logger.trace("Load sub environment with identifier `%s` from data store",n);const l=s.filter(e=>i.matchIdIsh(e,n)||e.name===n);return r.logger.trace("Found %d",l.length),i.ensureSingle(l,"sub environment")};t.promptEnvironment=async(e,n,s)=>{if(n||!e.Environment.length)return null;const l=a(e,s),u=e.Environment.filter(e=>e.parentId===l._id);if(!u.length)return r.logger.trace("No sub environments found, using base environment"),l;const c=new o.AutoComplete({name:"environment",message:"Select an environment",choices:u.map(e=>i.getDbChoice(i.generateIdIsh(e,14),e.name))});r.logger.trace("Prompt for environment");const[p]=(await c.run()).split(" - ").reverse();return t.loadEnvironment(e,s,p)}},function(e,t){e.exports=require("insomnia-send-request")},function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.lintSpecification=void 0;const i=n(31),r=n(2),a=n(5),s=n(0),l=n(3),u=o(n(4)),c=o(n(1));t.lintSpecification=async function(e,{workingDir:t,appDataDir:n,ci:o}){const p=await r.loadDb({workingDir:t,appDataDir:n,filterTypes:["ApiSpec"]}),d=e?a.loadApiSpec(p,e):await a.promptApiSpec(p,!!o);let f="";try{if(null==d?void 0:d.contents)s.logger.trace("Linting specification from database contents"),f=d.contents;else{if(!e)return s.logger.fatal("Specification not found."),!1;{const n=c.default.isAbsolute(e)?e:c.default.join(t||".",e);s.logger.trace(`Linting specification from file \`${n}\``);try{f=(await u.default.promises.readFile(n)).toString()}catch(e){throw new l.InsoError(`Failed to read "${n}"`,e)}}}}catch(e){return s.logger.fatal(e.message),!1}const g=new i.Spectral,m=await g.run(f);return m.length?(s.logger.log(m.length+" lint errors found. \n"),m.forEach(e=>s.logger.log(`${e.range.start.line}:${e.range.start.character} - ${e.message}`)),!1):(s.logger.log("No linting errors. Yay!"),!0)}},function(e,t){e.exports=require("@stoplight/spectral")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.exportSpecification=void 0;const o=n(2),i=n(5),r=n(10),a=n(0);t.exportSpecification=async function(e,{output:t,workingDir:n,appDataDir:s,ci:l}){const u=await o.loadDb({workingDir:n,appDataDir:s,filterTypes:["ApiSpec"]}),c=e?i.loadApiSpec(u,e):await i.promptApiSpec(u,!!l);if(!c)return a.logger.fatal("Specification not found."),!1;if(t){const e=await r.writeFileWithCliOptions(t,c.contents,n);a.logger.log(`Specification exported to "${e}".`)}else a.logger.log(c.contents);return!0}},function(e,t){e.exports=require("string-argv")},function(e,t){e.exports=require("commander")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOptions=t.extractCommandOptions=t.loadCosmiConfig=void 0;const o=n(36),i=["appDataDir","workingDir","ci","verbose","printOptions"];t.loadCosmiConfig=e=>{var t;try{const n=o.cosmiconfigSync("inso"),r=e?n.load(e):n.search();if(r&&!(null==r?void 0:r.isEmpty)){const e={};return i.forEach(t=>{var n,o;const i=null===(o=null===(n=r.config)||void 0===n?void 0:n.options)||void 0===o?void 0:o[t];i&&(e[t]=i)}),{__configFile:{options:e,scripts:(null===(t=r.config)||void 0===t?void 0:t.scripts)||{},filePath:r.filepath}}}}catch(t){e&&(console.log(`Could not find config file at ${e}.`),console.error(t))}return{}};t.extractCommandOptions=e=>{let t={},n=e;do{t={...n.opts(),...t},n=n.parent}while(n);return t};t.getOptions=(e,n={})=>{const o=t.extractCommandOptions(e),{__configFile:i}=t.loadCosmiConfig(o.config);return i?{...n,...i.options||{},...o,__configFile:i}:{...n,...o}}},function(e,t){e.exports=require("cosmiconfig")}]);